const schedule = require('node-schedule');
const axios = require('axios');
const moment = require('moment-timezone');
const fs = require('fs');

module.exports.config = {
  name: 'autosent',
  version: '20.0.0',
  hasPermssion: 0,
  credits: 'Ã‚ÃŸhrÃ¥fÃ¹l ÃŽÃŸlÄm x Gemini',
  description: 'à§¨à§ª à¦˜à¦£à§à¦Ÿà¦¾ à§¨à§ªà¦Ÿà¦¿ à¦†à¦²à¦¾à¦¦à¦¾ à¦®à§‡à¦¸à§‡à¦œ à¦“ à¦²à¦¾à¦•à§à¦¸à¦¾à¦°à¦¿ à¦†à¦ªà¦¡à§‡à¦Ÿ',
  commandCategory: 'system',
  usages: '[]',
  cooldowns: 3
};

// ðŸ’Ž à§¨à§ª à¦˜à¦£à§à¦Ÿà¦¾à¦° à§¨à§ªà¦Ÿà¦¿ à¦¸à§à¦ªà§‡à¦¶à¦¾à¦² à¦°à¦¾à¦œà¦•à§€à¦¯à¦¼ à¦®à§‡à¦¸à§‡à¦œ (à¦¤à¦¾à¦°à¦¿à¦« à¦“ à¦®à§‹à¦Ÿà¦¿à¦­à§‡à¦¶à¦¨ à¦¸à¦¹)
const quotes = {
  0: "à¦®à¦§à§à¦¯à¦°à¦¾à¦¤: à¦šà¦¾à¦°à¦ªà¦¾à¦¶ à¦¨à¦¿à¦à§à¦®, à¦¶à§à¦§à§ à¦šà¦¾à¦à¦¦à§‡à¦° à¦ªà¦¾à¦¹à¦¾à§œ à¦œà§‡à¦—à§‡ à¦†à¦›à§‡ à¦†à¦ªà¦¨à¦¾à¦° à¦ªà¦¾à¦¹à¦¾à¦°à¦¾à¦¯à¦¼! ðŸŒ™",
  1: "à¦°à¦¾à¦¤ à§§à¦Ÿà¦¾: à¦à¦‡ à¦¨à¦¿à¦°à§à¦œà¦¨ à¦°à¦¾à¦¤ à¦¬à¦²à¦›à§‡â€” à¦†à¦ªà¦¨à¦¿à¦“ à¦à¦•à¦¦à¦¿à¦¨ à¦¸à¦«à¦² à¦¹à¦¬à§‡à¦¨, à¦§à§ˆà¦°à§à¦¯ à¦§à¦°à§à¦¨à¥¤ âœ¨",
  2: "à¦°à¦¾à¦¤ à§¨à¦Ÿà¦¾: à¦¯à¦¾à¦°à¦¾ à¦¸à§à¦¬à¦ªà§à¦¨ à¦¦à§‡à¦–à§‡ à¦¤à¦¾à¦°à¦¾à¦‡ à¦ªà§ƒà¦¥à¦¿à¦¬à§€ à¦œà§Ÿ à¦•à¦°à§‡, à¦à¦–à¦¨ à¦¶à§à¦§à§ à¦˜à§à¦®à§‡à¦° à¦ªà¦¾à¦²à¦¾à¥¤ ðŸ’¤",
  3: "à¦°à¦¾à¦¤ à§©à¦Ÿà¦¾: à¦¶à§‡à¦· à¦°à¦¾à¦¤à§‡à¦° à¦ªà§à¦°à¦¾à¦°à§à¦¥à¦¨à¦¾ à¦†à¦° à¦¨à§€à¦°à¦¬à¦¤à¦¾â€” à¦†à¦¤à§à¦®à¦¾à¦° à¦ªà§à¦°à¦¶à¦¾à¦¨à§à¦¤à¦¿ à¦¦à§‡à§Ÿà¥¤ ðŸ¤²",
  4: "à¦­à§‹à¦° à§ªà¦Ÿà¦¾: à¦…à¦¨à§à¦§à¦•à¦¾à¦°à§‡à¦° à¦¶à§‡à¦·à§‡à¦‡ à¦†à¦²à§‹à¦° à¦œà¦¨à§à¦®, à¦¸à§à¦¨à¦¿à¦—à§à¦§ à¦­à§‹à¦°à§‡à¦° à¦¶à§à¦­ à¦•à¦¾à¦®à¦¨à¦¾à¥¤ ðŸŒ…",
  5: "à¦­à§‹à¦° à§«à¦Ÿà¦¾: à¦¶à§à¦­ à¦¸à¦•à¦¾à¦²! à¦†à¦œ à¦†à¦ªà¦¨à¦¾à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿ à¦¹à¦¬à§‡ à¦…à¦¸à¦®à§à¦­à¦¬ à¦¸à§à¦¨à§à¦¦à¦° à¦“ à¦°à¦™à¦¿à¦¨à¥¤ ðŸŒ¸",
  6: "à¦¸à¦•à¦¾à¦² à§¬à¦Ÿà¦¾: à¦¸à§‚à¦°à§à¦¯à§‡à¦° à¦ªà§à¦°à¦¥à¦® à¦†à¦²à§‹ à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦°à¦¾à¦œà¦•à§€à§Ÿ à¦…à¦­à§à¦¯à¦°à§à¦¥à¦¨à¦¾ à¦œà¦¾à¦¨à¦¾à¦šà§à¦›à§‡à¥¤ â˜€ï¸",
  7: "à¦¸à¦•à¦¾à¦² à§­à¦Ÿà¦¾: à¦à¦• à¦•à¦¾à¦ª à¦šà¦¾ à¦†à¦° à¦¨à¦¤à§à¦¨ à¦‰à¦¦à§à¦¯à¦®â€” à¦¦à¦¿à¦¨à¦Ÿà¦¿ à¦¶à§à¦°à§ à¦¹à§‹à¦• à¦¦à¦¾à¦ªà¦Ÿà§‡à¦° à¦¸à¦¾à¦¥à§‡à¥¤ â˜•",
  8: "à¦¸à¦•à¦¾à¦² à§®à¦Ÿà¦¾: à¦¸à¦®à§Ÿà§‡à¦° à¦®à§‚à¦²à§à¦¯ à¦¬à§à¦à¦²à§‡ à¦ªà§ƒà¦¥à¦¿à¦¬à§€ à¦†à¦ªà¦¨à¦¾à¦° à¦ªà¦¾à§Ÿà§‡à¦° à¦¨à¦¿à¦šà§‡ à¦¥à¦¾à¦•à¦¬à§‡à¥¤ â±ï¸",
  9: "à¦¸à¦•à¦¾à¦² à§¯à¦Ÿà¦¾: à¦¬à§à¦¯à¦¸à§à¦¤ à¦¶à¦¹à¦°, à¦¬à§à¦¯à¦¸à§à¦¤ à¦œà§€à¦¬à¦¨â€” à¦¤à¦¾à¦“ à¦šà¦¾à¦à¦¦à§‡à¦° à¦ªà¦¾à¦¹à¦¾à§œ à¦†à¦ªà¦¨à¦¾à¦° à¦ªà¦¾à¦¶à§‡à¥¤ ðŸ›°ï¸",
  10: "à¦¸à¦•à¦¾à¦² à§§à§¦à¦Ÿà¦¾: à¦•à¦¾à¦œà§‡à¦° à¦«à¦¾à¦à¦•à§‡ à¦à¦•à¦Ÿà§ à¦¹à¦¾à¦¸à¦¿â€” à¦®à¦¨à¦Ÿà¦¾à¦•à§‡ à¦¸à¦œà§€à¦¬ à¦•à¦°à§‡ à¦¤à§‹à¦²à§‡à¥¤ ðŸ˜Š",
  11: "à¦¸à¦•à¦¾à¦² à§§à§§à¦Ÿà¦¾: à¦°à§‹à¦¦ à¦¬à¦¾à§œà¦›à§‡, à¦¸à¦¾à¦¥à§‡ à¦¬à¦¾à§œà¦›à§‡ à¦†à¦ªà¦¨à¦¾à¦° à¦¸à¦«à¦²à¦¤à¦¾à¦° à¦¤à§‡à¦œ! ðŸ‘‘",
  12: "à¦¦à§à¦ªà§à¦° à§§à§¨à¦Ÿà¦¾: à¦®à¦§à§à¦¯à¦—à¦—à¦£à§‡ à¦¸à§‚à¦°à§à¦¯â€” à¦œà§€à¦¬à¦¨à§‡à¦° à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ à¦•à§à¦·à§‡à¦¤à§à¦°à§‡ à¦‰à¦œà§à¦œà§à¦¬à¦² à¦¥à¦¾à¦•à§à¦¨à¥¤ ðŸ’Ž",
  13: "à¦¦à§à¦ªà§à¦° à§§à¦Ÿà¦¾: à¦²à¦¾à¦žà§à¦š à¦¬à§à¦°à§‡à¦•! à¦ªà§‡à¦Ÿ à¦ªà§à¦œà§‹à¦Ÿà¦¾ à¦°à¦¾à¦œà¦•à§€à§Ÿ à¦¹à¦“à§Ÿà¦¾ à¦šà¦¾à¦‡, à¦¤à¦¾à¦‡ à¦¨à¦¾? ðŸ±",
  14: "à¦¦à§à¦ªà§à¦° à§¨à¦Ÿà¦¾: à¦°à§‹à¦¦à§‡à¦²à¦¾ à¦¦à§à¦ªà§à¦°à§‡ à¦†à¦²à¦¸à§‡à¦®à¦¿ à¦à§‡à§œà§‡ à¦†à¦¬à¦¾à¦° à¦•à¦¾à¦œà§‡ à¦®à¦¨à§‹à¦¯à§‹à¦—à§€ à¦¹à§‹à¦¨à¥¤ ðŸš€",
  15: "à¦¬à¦¿à¦•à§‡à¦² à§©à¦Ÿà¦¾: à¦ªà§œà¦¨à§à¦¤ à¦¦à§à¦ªà§à¦°à§‡à¦° à¦®à¦¾à§Ÿà¦¾ à¦¬à§œà¦‡ à¦…à¦¦à§à¦­à§à¦¤, à¦®à¦¨à¦Ÿà¦¾ à¦‰à§œà§ à¦‰à§œà§ à¦•à¦°à§‡à¥¤ ðŸƒ",
  16: "à¦¬à¦¿à¦•à§‡à¦² à§ªà¦Ÿà¦¾: à¦¬à¦¿à¦•à§‡à¦²à§‡à¦° à¦šà¦¾ à¦†à¦° à¦†à¦¡à§à¦¡à¦¾â€” à¦œà§€à¦¬à¦¨à§‡à¦° à¦›à§‹à¦Ÿ à¦›à§‹à¦Ÿ à¦¸à§à¦–à¥¤ ðŸ¥¨",
  17: "à¦¬à¦¿à¦•à§‡à¦² à§«à¦Ÿà¦¾: à¦—à§‹à¦§à§‚à¦²à¦¿à¦° à¦†à¦²à§‹à§Ÿ à¦†à¦•à¦¾à¦¶à¦Ÿà¦¾ à¦¯à§‡à¦¨ à¦•à§à¦¯à¦¾à¦¨à¦­à¦¾à¦¸à§‡ à¦†à¦à¦•à¦¾ à¦›à¦¬à¦¿à¥¤ ðŸŽ¨",
  18: "à¦¸à¦¨à§à¦§à§à¦¯à¦¾ à§¬à¦Ÿà¦¾: à¦¸à¦¨à§à¦§à§à¦¯à¦¾ à¦¨à¦¾à¦®à¦›à§‡, à¦¦à¦¿à¦¨à§‡à¦° à¦•à§à¦²à¦¾à¦¨à§à¦¤à¦¿ à¦®à§à¦›à§‡ à¦¶à¦¾à¦¨à§à¦¤à¦¿ à¦†à¦¸à§à¦• à¦˜à¦°à§‡à¥¤ ðŸ ",
  19: "à¦¸à¦¨à§à¦§à§à¦¯à¦¾ à§­à¦Ÿà¦¾: à¦…à¦¨à§à¦§à¦•à¦¾à¦°à§‡à¦° à¦®à¦¾à¦à§‡à¦“ à¦œà§‹à¦¨à¦¾à¦•à¦¿à¦° à¦®à¦¤à§‹ à¦œà§à¦¬à¦²à§‡ à¦‰à¦ à§à¦• à¦†à¦ªà¦¨à¦¾à¦° à¦®à§‡à¦§à¦¾à¥¤ ðŸ’¡",
  20: "à¦°à¦¾à¦¤ à§®à¦Ÿà¦¾: à¦ªà¦°à¦¿à¦¬à¦¾à¦° à¦†à¦° à¦ªà§à¦°à¦¿à§Ÿà¦œà¦¨à¦¦à§‡à¦° à¦¨à¦¿à§Ÿà§‡ à¦¸à§à¦¨à§à¦¦à¦° à¦•à¦¿à¦›à§ à¦®à§à¦¹à§‚à¦°à§à¦¤ à¦•à¦¾à¦Ÿà¦¾à¦¨à¥¤ â¤ï¸",
  21: "à¦°à¦¾à¦¤ à§¯à¦Ÿà¦¾: à¦¡à¦¿à¦¨à¦¾à¦°à§‡à¦° à¦¸à¦®à§Ÿâ€” à¦°à¦¾à¦¤à§‡à¦° à¦¶à¦¾à¦¨à§à¦¤à¦¿ à¦‰à¦ªà¦­à§‹à¦— à¦•à¦°à§à¦¨ à¦†à¦ªà¦¨ à¦®à¦¨à§‡à¥¤ ðŸ›",
  22: "à¦°à¦¾à¦¤ à§§à§¦à¦Ÿà¦¾: à¦•à¦¾à¦œ à¦¶à§‡à¦·? à¦à¦¬à¦¾à¦° à¦¨à¦¿à¦œà§‡à¦•à§‡ à¦¸à¦®à§Ÿ à¦¦à§‡à¦“à§Ÿà¦¾à¦° à¦ªà¦¾à¦²à¦¾à¥¤ ðŸŽ§",
  23: "à¦°à¦¾à¦¤ à§§à§§à¦Ÿà¦¾: à¦¦à¦¿à¦¨à§‡à¦° à¦¶à§‡à¦·à§‡ à¦¨à¦¿à¦œà§‡à¦•à§‡ à¦¬à¦²à§à¦¨â€” 'à¦†à¦œ à¦†à¦®à¦¿ à¦¸à§‡à¦°à¦¾à¦Ÿà¦¾ à¦¦à¦¿à§Ÿà§‡à¦›à¦¿'à¥¤ ðŸ†"
};

module.exports.onLoad = ({ api }) => {
  const rule = new schedule.RecurrenceRule();
  rule.tz = 'Asia/Dhaka';
  rule.minute = 0; 

  schedule.scheduleJob(rule, async () => {
    try {
      const now = moment().tz('Asia/Dhaka');
      const time = now.format('hh:mm A');
      const date = now.format('DD MMMM, YYYY');
      const day = now.format('dddd');
      const hour = now.hour();

      // à§§. à¦•à§à§œà¦¿à¦—à§à¦°à¦¾à¦® à¦“ à¦°à§Œà¦®à¦¾à¦°à§€ à¦†à¦¬à¦¹à¦¾à¦“à§Ÿà¦¾ à¦¡à¦¾à¦Ÿà¦¾
      let weatherInfo = "Signal Weak â˜ï¸";
      try {
        const res = await axios.get(`https://api.openweathermap.org/data/2.5/weather?q=Kurigram&units=metric&appid=e38b33e1d689b0284980484b9071060b`);
        const temp = Math.round(res.data.main.temp);
        const desc = res.data.weather[0].description.toUpperCase();
        weatherInfo = `${temp}Â°C | ${desc}`;
      } catch (e) {}

      // à§¨. à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦¸à¦®à§Ÿà¦¸à§‚à¦šà§€
      let prayerInfo = "Update Pending ðŸ•‹";
      try {
        const pr = await axios.get(`https://api.aladhan.com/v1/timingsByCity?city=Kurigram&country=Bangladesh&method=2`);
        const p = pr.data.data.timings;
        prayerInfo = `ð—™ð—®ð—·ð—¿: ${p.Fajr} | ð——ð—µð˜‚ð—µð—¿: ${p.Dhuhr} | ð—”ð˜€ð—¿: ${p.Asr} | ð— ð—®ð—´ð—µð—¿ð—¶ð—¯: ${p.Maghrib} | ð—œð˜€ð—µð—®: ${p.Isha}`;
      } catch (e) {}

      const ram = (process.memoryUsage().heapUsed / 1024 / 1024).toFixed(2);
      const quote = quotes[hour]; // à§¨à§ª à¦˜à¦£à§à¦Ÿà¦¾à¦° à¦œà¦¨à§à¦¯ à§¨à§ªà¦Ÿà¦¿ à¦†à¦²à¦¾à¦¦à¦¾ à¦®à§‡à¦¸à§‡à¦œ

      const msg = `
â”â”â”â”â”â”â”â” ðŸ›°ï¸ â”â”â”â”â”â”â”â”“
   ðŸ’  ð—–ð—›ð—”ð—¡ð——ð—˜ð—¥ ð—£ð—”ð—›ð—”ð—¥ ð—¨ð—Ÿð—§ð—¥ð—”-ð—¡ð—˜ð—§ ðŸ’ 
â”—â”â”â”â”â”â”â” ðŸŒŒ â”â”â”â”â”â”â”â”›

 ðŸ•’ ð—§ð—¶ð—ºð—²    : ${time}
 ðŸ“… ð——ð—®ð˜ð—²    : ${date} (${day})
 ðŸ“ ð—Ÿð—¼ð—°ð—®ð˜ð—¶ð—¼ð—»: Kurigram, Rowmari
 ðŸŒ¡ï¸ ð—ªð—²ð—®ð˜ð—µð—²ð—¿  : ${weatherInfo}

 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸ“œ ð— ð—˜ð—¦ð—¦ð—”ð—šð—˜:
 ã€Œ ${quote} ã€
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

 ðŸ•‹ ð—£ð—¥ð—”ð—¬ð—˜ð—¥ ð—§ð—œð— ð—˜ð—¦:
 ${prayerInfo}

 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ðŸš€ ð—¦ð˜†ð˜€ð˜ð—²ð—º ð—¥ð—”ð—  : ${ram} MB
 âœ… ð—¦ð˜ð—®ð˜ð˜‚ð˜€: Active & Optimized
 ðŸ”ï¸ âœ¡ï¸âƒðŸ…°ðŸ…³ðŸ…¼ðŸ…¸ðŸ…½ â—ŽâƒðŸ˜˜â”€Í¢Í¢à¦šà§ƒà¦¾à¦à¦¦à§‡à§ƒà¦à¦°à§ƒà¦ à¦ªà¦¾à§ƒà¦à¦¹à¦¾à§à¦à¦¡à¦¼à§ƒà¦âœ¡ï¸âŽžðŸª½
`;

      const allThreads = global.data.allThreadID || [];
      for (const threadID of allThreads) {
        api.sendMessage(msg, threadID);
        await new Promise(res => setTimeout(res, 1000)); 
      }

    } catch (err) { console.error(err); }
  });
};

module.exports.run = () => {};
